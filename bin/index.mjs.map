{"version":3,"sources":["../src/index.ts"],"sourcesContent":["#!/usr/bin/env node\n\nimport fs from 'fs';\nimport { Command } from 'commander'; //可以解析用户输入的命令\nimport download from 'obtain-git-repo';\nimport chalk from 'chalk'; //改变输出文字的颜色\nimport inquirer from 'inquirer';\nimport ora from 'ora'; //小图标（loading、succeed、warn等）\ndownload('', '', {}, () => {});\nimport packageJSON from '../package.json';\nconst program = new Command();\n\nconst question = [\n  {\n    type: 'list',\n    message: `请选择开发项目的语言? `,\n    name: 'type',\n    choices: ['TypeScript'],\n  },\n  {\n    type: 'input',\n    message: `项目名称: `,\n    name: 'name',\n    default: 'my-plugin',\n  },\n  {\n    type: 'input',\n    message: `项目描述: `,\n    name: 'description',\n    default: '',\n  },\n  {\n    type: 'input',\n    message: `初始版本: `,\n    name: 'version',\n    default: '1.0.0',\n  },\n];\n\nprogram\n  .version(packageJSON.version, '-v, --version')\n  .command('init <pkgName>')\n  .action(async (pkgName) => {\n    if (fs.existsSync(pkgName)) {\n      console.log(chalk.red('项目已存在'));\n      return;\n    }\n    const { type, name, description, version } = await inquirer.prompt(\n      question\n    );\n    let downloadUrl = '';\n\n    if (type === 'TypeScript') {\n      downloadUrl = 'asasugar/plugin-tstemp';\n    }\n\n    const spinner = ora('正在从github下载...').start();\n    download(downloadUrl, name, {}, function (err: any) {\n      if (!err) {\n        spinner.clear();\n        console.info('');\n        console.info(\n          chalk.green('-----------------------------------------------------')\n        );\n        console.info('');\n        spinner.succeed('项目创建成功,请继续进行以下操作:');\n        console.info('');\n        console.info(\n          chalk.gray('安装pnpm参考文档: https://github.com/pnpm/pnpm')\n        );\n        console.info('');\n        console.info(chalk.cyan(` -  cd ${name}`));\n        console.info(chalk.cyan(` -  pnpm install`));\n        console.info(chalk.cyan(` -  pnpm dev`));\n        console.info(chalk.cyan(` -  pnpm build`));\n        console.info('');\n        console.info(\n          chalk.gray('参考文档: https://github.com/asasugar/pkg-cli/')\n        );\n        console.info('');\n        console.info(\n          chalk.green('-----------------------------------------------------')\n        );\n        console.info('');\n\n        fs.readFile(`${process.cwd()}/${name}/package.json`, (err, data) => {\n          if (err) throw err;\n          let _data = JSON.parse(data.toString());\n          _data.name = name;\n          _data.description = description;\n          _data.version = version;\n          let str = JSON.stringify(_data, null, 4);\n          fs.writeFile(\n            `${process.cwd()}/${name}/package.json`,\n            str,\n            function (err) {\n              if (err) throw err;\n              process.exit();\n            }\n          );\n        });\n      } else {\n        spinner.warn(\n          '发生错误，请在https://github.com/asasugar/pkg-cli/issues，Issues留言'\n        );\n        process.exit();\n      }\n    });\n  })\n  .parse(process.argv);\n"],"mappings":";AAEA,kBACA,oCACA,+BACA,qBACA,wBACA,w9BACA,EAAS,GAAI,GAAI,GAAI,IAAM,IAE3B,GAAM,GAAU,GAAI,GAEd,EAAW,CACf,CACE,KAAM,OACN,QAAS,iEACT,KAAM,OACN,QAAS,CAAC,eAEZ,CACE,KAAM,QACN,QAAS,6BACT,KAAM,OACN,QAAS,aAEX,CACE,KAAM,QACN,QAAS,6BACT,KAAM,cACN,QAAS,IAEX,CACE,KAAM,QACN,QAAS,6BACT,KAAM,UACN,QAAS,UAIb,EACG,QAAQ,EAAY,QAAS,iBAC7B,QAAQ,kBACR,OAAO,KAAO,IAAY,CACzB,GAAI,EAAG,WAAW,GAAU,CAC1B,QAAQ,IAAI,EAAM,IAAI,mCACtB,OAEF,GAAM,CAAE,OAAM,OAAM,cAAa,WAAY,KAAM,GAAS,OAC1D,GAEE,EAAc,GAElB,AAAI,IAAS,cACX,GAAc,0BAGhB,GAAM,GAAU,EAAI,2CAAkB,QACtC,EAAS,EAAa,EAAM,GAAI,SAAU,EAAU,CAClD,AAAK,EA4CH,GAAQ,KACN,gHAEF,QAAQ,QA9CR,GAAQ,QACR,QAAQ,KAAK,IACb,QAAQ,KACN,EAAM,MAAM,0DAEd,QAAQ,KAAK,IACb,EAAQ,QAAQ,gGAChB,QAAQ,KAAK,IACb,QAAQ,KACN,EAAM,KAAK,2EAEb,QAAQ,KAAK,IACb,QAAQ,KAAK,EAAM,KAAK,UAAU,MAClC,QAAQ,KAAK,EAAM,KAAK,qBACxB,QAAQ,KAAK,EAAM,KAAK,iBACxB,QAAQ,KAAK,EAAM,KAAK,mBACxB,QAAQ,KAAK,IACb,QAAQ,KACN,EAAM,KAAK,mEAEb,QAAQ,KAAK,IACb,QAAQ,KACN,EAAM,MAAM,0DAEd,QAAQ,KAAK,IAEb,EAAG,SAAS,GAAG,QAAQ,SAAS,iBAAqB,CAAC,EAAK,IAAS,CAClE,GAAI,EAAK,KAAM,GACf,GAAI,GAAQ,KAAK,MAAM,EAAK,YAC5B,EAAM,KAAO,EACb,EAAM,YAAc,EACpB,EAAM,QAAU,EAChB,GAAI,GAAM,KAAK,UAAU,EAAO,KAAM,GACtC,EAAG,UACD,GAAG,QAAQ,SAAS,iBACpB,EACA,SAAU,EAAK,CACb,GAAI,EAAK,KAAM,GACf,QAAQ,gBAYnB,MAAM,QAAQ","names":[]}